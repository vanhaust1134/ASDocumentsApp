App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =//Phân quyền màn hình
        If(Not(IsBlank(Param("Function"))),Set(gblFunction,Param("Function"));Set(gblRole,Param("Role"));If(gblFunction = "MasterDataDocument" Or gblRole = 5,Navigate('User Screen'),gblFunction = "ManageDocument" And Or(gblRole = 1,gblRole = 2,gblRole = 4),Navigate('Home User Screen'),gblFunction = "ManageDocument" And gblRole = 3,Navigate('Home Manager Screen')),
        If(
            LookUp(
                'ASDocument.Users_Roles',
                userID = LookUp(
                    'ASTakeLeave.Users',
                    email = User().Email And active = 1
                ).userID And active = 1
            ).roleID = 5,Navigate('User Screen'),LookUp(
                'ASDocument.Users_Roles',
                userID = LookUp(
                    'ASTakeLeave.Users',
                    email = User().Email And active = 1
                ).userID And active = 1
            ).roleID = 3,
            Navigate('Home Manager Screen'),
            LookUp(
                'ASDocument.Users_Roles',
                userID = LookUp(
                    'ASTakeLeave.Users',
                    email = User().Email And active = 1
                ).userID And active = 1
            ).roleID = 1,
            Navigate('Home User Screen'),
            Navigate('Home Manager Screen')
        ))
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

