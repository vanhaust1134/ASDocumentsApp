"'Request Screen' As screen":
    Fill: =RGBA(224,224,224,1)
    OnHidden: |-
        =UpdateContext({locReview:false})
    OnVisible: |-
        =//Xóa bảng quy trình phê duyệt
        Clear(colApprovesPeopleProcess);
        
        //Cập nhật mã văn bản
        UpdateContext(
                {
                    locDocumentIDGenerate: drp_rs_CompanyNameInput.Selected.shortName & "-" & drp_rs_CompanyNameInput_2.Selected.shortName & "-" & drp_rs_DocumentType.Selected.shortName & locNumberCountRequest & "-" & Upper(
                        Concat(
                            Split(
                                txt_rs_DocumentName.Text,
                                " "
                            ),
                            Left(
                                Value,
                                1
                            )
                        )
                    )
                }
            );
        
        //Lấy danh sách MSD chọn theo cấp
        If(drp_rs_DocumentLevel.Selected.documentGroupID = 1,ClearCollect(colMSDByDocumentLevel,Filter('ASDocument.MSDApproval',levelID = drp_rs_DocumentLevel.Selected.levelID And active = 1)),
        ClearCollect(colUserMSD,Filter(gblColAllUser,userID exactin (colMSDByDocumentLevel).userID)));
        
        //Cập nhật MSD vào luồng phê duyệt
        RemoveIf(colApprovesPeopleProcess,BaseID = 2 And ID = 1);
        RemoveIf(colApprovesPeopleProcess,BaseID = 2 And ID = 2);
        
        ForAll(Filter(colMSDByDocumentLevel,levelID = drp_rs_DocumentLevel.Selected.levelID) As Temp,Collect(colApprovesPeopleProcess,Table({ID:Max(Filter(colApprovesPeopleProcess,BaseID = 2),ID) + 1,userID:Temp.userID,BaseID:2,approveProcess:2,sort:Max(colApprovesPeopleProcess,ID),documentID:locDocumentIDGenerate})));

    btn_rs_BackGroundScreen As button:
        BorderStyle: =BorderStyle.None
        DisabledFill: =RGBA(241, 244, 250, 1)
        DisplayMode: =DisplayMode.Disabled
        Height: =767
        RadiusBottomLeft: =20
        RadiusBottomRight: =20
        RadiusTopLeft: =20
        RadiusTopRight: =20
        Text: =""
        Width: =1366
        ZIndex: =1

    ctn_rs_Title As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Height: =41
        LayoutMode: =LayoutMode.Auto
        PaddingLeft: =30
        PaddingRight: =30
        Width: =1170
        X: =196
        Y: =104
        ZIndex: =20

        lbl_rs_Title As label:
            AlignInContainer: =AlignInContainer.Stretch
            Color: =RGBA(43, 54, 74, 1)
            FontWeight: =FontWeight.Bold
            Height: =41
            Size: =18
            Text: ="Tạo mới yêu cầu trình duyệt"
            Width: =350
            X: =191
            Y: =101
            ZIndex: =1

    btn_rs_BackGround As button:
        BorderStyle: =BorderStyle.None
        BorderThickness: =0.1
        DisabledFill: =RGBA(246, 245, 250, 1)
        DisplayMode: =DisplayMode.Disabled
        Height: =609
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        Text: =""
        Width: =1136
        X: =196
        Y: =159
        ZIndex: =22

    ctn_rs_MainContent As groupContainer.horizontalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Height: =606
        LayoutGap: =10
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =10
        PaddingLeft: =35
        PaddingRight: =35
        PaddingTop: =10
        Width: =1169
        X: =196
        Y: =159
        ZIndex: =23

        ctn_rs_Form As groupContainer.horizontalAutoLayoutContainer:
            DropShadow: =DropShadow.None
            Fill: =RGBA(255, 255, 255, 1)
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            ZIndex: =5

            ctn_rs_FormDetail2 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =10
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =10
                PaddingRight: =10
                ZIndex: =1

                ctn_rs_DocumentDetail As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutOverflowY: =LayoutOverflow.Scroll
                    PaddingLeft: =12
                    PaddingRight: =12
                    ZIndex: =4

                    ctn_rs_CompanyName As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =90
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =1

                        lbl_rs_CompanyName As label:
                            Color: =RGBA(94, 94, 94, 1)
                            FontWeight: =FontWeight.Semibold
                            Size: =15
                            Text: ="Công ty"
                            ZIndex: =1

                        ctn_rs_CompanyNameInput As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            LayoutGap: =15
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =1
                            PaddingRight: =1
                            ZIndex: =3

                            drp_rs_CompanyNameInput As dropdown:
                                BorderColor: =RGBA(0, 0, 0, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(73, 113, 215, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisabledFill: =RGBA(255, 255, 255, 1)
                                FillPortions: =1
                                Items: =Filter(gblColCompany,name <> "Tất cả")
                                LayoutMinWidth: =100
                                ZIndex: =1

                            drp_rs_CompanyNameInput_2 As dropdown:
                                BorderColor: =RGBA(0, 0, 0, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(73, 113, 215, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisabledFill: =RGBA(255, 255, 255, 1)
                                FillPortions: =1
                                Items: =Filter(gblColDivision,companyID = drp_rs_CompanyNameInput.Selected.ID)
                                LayoutMinWidth: =100
                                ZIndex: =2

                    ctn_rs_DocumentType As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =90
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =2

                        lbl_rs_DocumentType As label:
                            Color: =RGBA(94, 94, 94, 1)
                            FontWeight: =FontWeight.Semibold
                            Size: =15
                            Text: ="Loại tài liệu"
                            ZIndex: =1

                        ctn_rs_DocumentTypeInput As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            LayoutGap: =15
                            LayoutMinHeight: =50
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =1
                            PaddingRight: =1
                            ZIndex: =3

                            drp_rs_DocumentLevel As dropdown:
                                BorderColor: =RGBA(0, 0, 0, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(73, 113, 215, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisabledFill: =RGBA(255, 255, 255, 1)
                                FillPortions: =1
                                Items: =Filter(gblColDocumentLevel,name <> "Tất cả")
                                LayoutMinWidth: =100
                                OnChange: |-
                                    =//Lấy danh sách MSD chọn theo cấp
                                    If(drp_rs_DocumentLevel.Selected.documentGroupID = 1,ClearCollect(colMSDByDocumentLevel,Filter('ASDocument.MSDApproval',levelID = drp_rs_DocumentLevel.Selected.levelID And active = 1)),
                                    ClearCollect(colUserMSD,Filter(gblColAllUser,userID exactin (colMSDByDocumentLevel).userID)));
                                    
                                    //Cập nhật MSD vào luồng phê duyệt
                                    RemoveIf(colApprovesPeopleProcess,BaseID = 2 And ID = 1);
                                    RemoveIf(colApprovesPeopleProcess,BaseID = 2 And ID = 2);
                                    
                                    ForAll(Filter(colMSDByDocumentLevel,levelID = drp_rs_DocumentLevel.Selected.levelID) As Temp,Collect(colApprovesPeopleProcess,Table({ID:Max(Filter(colApprovesPeopleProcess,BaseID = 2),ID) + 1,userID:Temp.userID,BaseID:2,approveProcess:2,sort:Max(colApprovesPeopleProcess,ID),documentID:locDocumentIDGenerate})));
                                ZIndex: =1

                            drp_rs_DocumentType As dropdown:
                                BorderColor: =RGBA(0, 0, 0, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(73, 113, 215, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisabledFill: =RGBA(255, 255, 255, 1)
                                FillPortions: =1
                                Items: =Filter(gblColDocumentType,levelID = drp_rs_DocumentLevel.Selected.levelID)
                                LayoutMinWidth: =100
                                ZIndex: =2

                    lbl_rs_FileCode As label:
                        Color: =RGBA(94, 94, 94, 1)
                        FontWeight: =FontWeight.Semibold
                        Size: =15
                        Text: ="Mã hồ sơ"
                        Visible: =If(drp_rs_DocumentLevel.Selected.levelID = 4 Or drp_rs_DocumentLevel.Selected.levelID = 5,true,false)
                        ZIndex: =3

                    txt_rs_FileCodeInput As text:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =1
                        Default: =""
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        Format: =TextFormat.Number
                        HintText: ="Nhập mã hồ sơ"
                        Mode: =TextMode.MultiLine
                        PaddingTop: =10
                        Visible: =If(drp_rs_DocumentLevel.Selected.levelID = 4 Or drp_rs_DocumentLevel.Selected.levelID = 5,true,false)
                        ZIndex: =4

                    lbl_rs_DocumentName As label:
                        Color: =RGBA(94, 94, 94, 1)
                        FontWeight: =FontWeight.Semibold
                        Size: =15
                        Text: ="Tên văn bản"
                        ZIndex: =5

                    txt_rs_DocumentName As text:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =1
                        Default: =""
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        Height: =100
                        HintText: ="Nhập tên văn bản"
                        Mode: =TextMode.MultiLine
                        PaddingTop: =10
                        ZIndex: =6

                    frm_rs_Document As form:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DataSource: ='ASDocument.DocumentApproveRequest'
                        DefaultMode: =FormMode.New
                        FillPortions: =0
                        Height: =165
                        LayoutMinHeight: =250
                        LayoutMinWidth: =400
                        ZIndex: =7

                        Attachments_DataCard2 As typedDataCard.attachmentsEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="{Attachments}"
                            Default: =ThisItem.Attachments
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="Đính kèm"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =160
                            Required: =false
                            Update: =DataCardValue5.Attachments
                            Width: =498
                            X: =0
                            Y: =0
                            ZIndex: =4

                            DataCardKey6 As label:
                                AutoHeight: =true
                                Color: =RGBA(94, 94, 94, 1)
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                Size: =15
                                Text: ="File văn bản"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =2
                                Y: =10
                                ZIndex: =1

                            DataCardValue5 As attachments:
                                AddAttachmentText: ="Đính kèm"
                                BorderColor: |-
                                    =//If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                    RGBA(0, 0, 0, 1)
                                BorderThickness: =1
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisabledFill: =RGBA(255, 255, 255, 1)
                                Height: =103
                                IsInDataCard: =true
                                Items: =Parent.Default
                                NoAttachmentsText: ="Không có tệp nào."
                                PaddingBottom: =5
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                PaddingRight: =5
                                PaddingTop: =5
                                Tooltip: =Parent.DisplayName
                                Width: =480
                                X: =2
                                Y: =DataCardKey6.Y + DataCardKey6.Height + 5
                                ZIndex: =2

                            ErrorMessage6 As label:
                                AutoHeight: =true
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue5.Y + DataCardValue5.Height
                                ZIndex: =3

                            StarVisible6 As label:
                                Align: =Align.Center
                                Height: =DataCardKey6.Height
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey6.Y
                                ZIndex: =4

                    lbl_rs_SignPage As label:
                        Color: =RGBA(94, 94, 94, 1)
                        FontWeight: =FontWeight.Semibold
                        Size: =15
                        Text: ="Số trang ký"
                        ZIndex: =8

                    txt_rs_SignPage As text:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =1
                        Default: =""
                        DisabledColor: =RGBA(0, 0, 0, 1)
                        DisabledFill: =RGBA(255, 255, 255, 1)
                        Format: =TextFormat.Number
                        HintText: ="Nhập số trang"
                        Mode: =TextMode.MultiLine
                        PaddingTop: =10
                        ZIndex: =9

                    frm_rs_Attachment As form:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DataSource: ='ASDocument.DocumentApproveRequest'
                        DefaultMode: =FormMode.New
                        FillPortions: =0
                        Height: =165
                        LayoutMinHeight: =250
                        LayoutMinWidth: =400
                        ZIndex: =10

                        Attachments_DataCard2_2 As typedDataCard.attachmentsEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="{Attachments}"
                            Default: =ThisItem.Attachments
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: ="Phụ lục đính kèm"
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =160
                            Required: =false
                            Update: =DataCardValue5_2.Attachments
                            Width: =498
                            X: =0
                            Y: =0
                            ZIndex: =4

                            DataCardKey6_2 As label:
                                AutoHeight: =true
                                Color: =RGBA(94, 94, 94, 1)
                                FontWeight: =FontWeight.Semibold
                                Height: =34
                                Size: =15
                                Text: ="Đính kèm"
                                Width: =Parent.Width - 60
                                Wrap: =false
                                X: =2
                                Y: =10
                                ZIndex: =1

                            DataCardValue5_2 As attachments:
                                AddAttachmentText: ="Đính kèm"
                                BorderColor: |-
                                    =//If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                    RGBA(0, 0, 0, 1)
                                BorderThickness: =1
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisabledFill: =RGBA(255, 255, 255, 1)
                                Height: =103
                                IsInDataCard: =true
                                Items: =Parent.Default
                                NoAttachmentsText: ="Không có tệp nào."
                                PaddingBottom: =5
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                PaddingRight: =5
                                PaddingTop: =5
                                Tooltip: =Parent.DisplayName
                                Width: =480
                                X: =2
                                Y: =DataCardKey6_2.Y + DataCardKey6_2.Height + 5
                                ZIndex: =2

                            ErrorMessage6_2 As label:
                                AutoHeight: =true
                                Height: =10
                                Live: =Live.Assertive
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =Parent.Error
                                Visible: =Parent.DisplayMode=DisplayMode.Edit
                                Width: =Parent.Width - 60
                                X: =30
                                Y: =DataCardValue5_2.Y + DataCardValue5_2.Height
                                ZIndex: =3

                            StarVisible6_2 As label:
                                Align: =Align.Center
                                Height: =DataCardKey6_2.Height
                                Text: ="*"
                                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                Width: =30
                                Wrap: =false
                                Y: =DataCardKey6_2.Y
                                ZIndex: =4

            ctn_rs_FormDetail1 As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =10
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingLeft: =10
                PaddingRight: =10
                ZIndex: =2

                ctn_rs_HandOver_2 As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =500
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    lbl_rs_HandOverTitle_2 As label:
                        Color: =RGBA(94, 94, 94, 1)
                        FontWeight: =FontWeight.Semibold
                        Size: =15
                        Text: ="Bước phê duyệt"
                        ZIndex: =1

                    Container3_2 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Fill: =RGBA(241, 244, 250, 1)
                        LayoutGap: =15
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        ZIndex: =2

                        Gallery12 As gallery.variableTemplateHeightGallery:
                            DelayItemLoading: =true
                            Items: |-
                                =Table({ID:1,Name:"Người xem xét"},{ID:2,Name:"MSD"},{ID:3,Name:"Người phê duyệt"})
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =0
                            LayoutMinWidth: =320
                            LoadingSpinner: =LoadingSpinner.Data
                            ShowScrollbar: =false
                            TemplateSize: =200
                            ZIndex: =1

                            Container4 As groupContainer.horizontalAutoLayoutContainer:
                                Fill: =RGBA(255, 255, 255, 1)
                                Height: =35
                                LayoutMode: =LayoutMode.Auto
                                Visible: =If(Or(drp_rs_DocumentLevel.Selected.levelID = 3,drp_rs_DocumentLevel.Selected.levelID = 4) And ThisItem.ID = 2,false,true)
                                Width: =499
                                ZIndex: =1

                                Label15 As label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Fill: =RGBA(255, 255, 255, 1)
                                    FillPortions: =8
                                    FontWeight: =FontWeight.Semibold
                                    LayoutMinHeight: =35
                                    PaddingLeft: =10
                                    Text: =ThisItem.Name
                                    ZIndex: =1

                                Image2 As image:
                                    AlignInContainer: =AlignInContainer.Center
                                    FillPortions: =1
                                    Height: =25
                                    Image: =Add
                                    LayoutMinHeight: =30
                                    LayoutMinWidth: =10
                                    OnSelect: |-
                                        =UpdateContext({locDocumentIDGenerate:drp_rs_CompanyNameInput.Selected.shortName & "-" & drp_rs_CompanyNameInput_2.Selected.shortName & "-" & drp_rs_DocumentType.Selected.shortName & locNumberCountRequest & "-" & Upper(Concat(Split(txt_rs_DocumentName.Text, " "), Left(Value, 1)))});
                                        
                                        If(ThisItem.ID = 1,If(CountRows(Filter(colApprovesPeopleProcess,BaseID = ThisItem.ID)) < 5,Collect(colApprovesPeopleProcess,Table({ID:Max(Filter(colApprovesPeopleProcess,BaseID = ThisItem.ID),ID) + 1,userID:"",BaseID:ThisItem.ID,approveProcess:1,sort:Max(colApprovesPeopleProcess,ID),documentID:locDocumentIDGenerate}))),ThisItem.ID = 3,If(CountRows(Filter(colApprovesPeopleProcess,BaseID = ThisItem.ID)) < 2,Collect(colApprovesPeopleProcess,Table({ID:Max(Filter(colApprovesPeopleProcess,BaseID = ThisItem.ID),ID) + 1,name:"",BaseID:ThisItem.ID,approveProcess:3,sort:Max(colApprovesPeopleProcess,ID),documentID:locDocumentIDGenerate}))));
                                    Visible: =If(ThisItem.ID = 2,false,true)
                                    ZIndex: =2

                            Gallery13 As gallery.galleryVertical:
                                DelayItemLoading: =true
                                Height: =40 * CountRows(Filter(colApprovesPeopleProcess,BaseID = ThisItem.ID))
                                Items: =Filter(colApprovesPeopleProcess,BaseID = ThisItem.ID)
                                Layout: =Layout.Vertical
                                LoadingSpinner: =LoadingSpinner.Data
                                ShowScrollbar: =false
                                TemplateSize: =35
                                Width: =452
                                X: =20
                                Y: =38
                                ZIndex: =2

                                Button5 As button:
                                    BorderStyle: =BorderStyle.None
                                    DisabledFill: =RGBA(73, 113, 215, 1)
                                    DisplayMode: =DisplayMode.Disabled
                                    Height: =26
                                    OnSelect: =Select(Parent)
                                    RadiusBottomLeft: =3
                                    RadiusBottomRight: =3
                                    RadiusTopLeft: =3
                                    RadiusTopRight: =3
                                    Text: =""
                                    Width: =30
                                    Y: =5
                                    ZIndex: =1

                                Label16_1 As label:
                                    Align: =Align.Center
                                    Color: =RGBA(255, 255, 255, 1)
                                    FontWeight: =FontWeight.Semibold
                                    Height: =26
                                    OnSelect: =Select(Parent)
                                    Text: =ThisItem.ID
                                    Width: =30
                                    Y: =5
                                    ZIndex: =3

                                ComboBox1 As combobox:
                                    BorderStyle: =BorderStyle.None
                                    ChevronBackground: =RGBA(73, 113, 215, 1)
                                    DefaultSelectedItems: =LookUp(gblColAllUser,userID = ThisItem.userID)
                                    DisplayFields: =["fullName","email"]
                                    Height: =35
                                    InputTextPlaceholder: ="Chọn nhân viên"
                                    IsSearchable: =false
                                    Items: =Switch(ThisItem.BaseID,1,Filter(gblColAllUser,roleID = 2),3,Filter(gblColAllUser,roleID = 4))
                                    NoSelectionText: ="Chọn nhân viên"
                                    OnChange: |-
                                        =Patch(colApprovesPeopleProcess,LookUp(colApprovesPeopleProcess,ID = ThisItem.ID And BaseID = ThisItem.BaseID),{userID:ComboBox1.Selected.userID})
                                    OnSelect: =Select(Parent)
                                    SearchFields: =["email"]
                                    SearchItems: =[]
                                    SelectMultiple: =false
                                    Template: =ListItemTemplate.Person
                                    X: =44
                                    ZIndex: =4

                                Image4 As image:
                                    Height: =25
                                    Image: =Delete
                                    OnSelect: =RemoveIf(colApprovesPeopleProcess,ID = ThisItem.ID And BaseID = ThisItem.BaseID)
                                    Width: =47
                                    X: =381
                                    Y: =5
                                    ZIndex: =5

                btn_rs_Submit As button:
                    AlignInContainer: =AlignInContainer.End
                    Fill: =RGBA(73, 113, 215, 1)
                    OnSelect: |
                        =If(
                            IsBlank(txt_rs_DocumentName.Text),
                            Notify(
                                "Trường tên văn bản không được để trống",
                                NotificationType.Error,
                                1500
                            ),
                            UpdateContext({locSubmit: true});
                            UpdateContext(
                                {
                                    locNumberCountRequest: If(
                                        !IsEmpty(
                                            Filter(
                                                'ASDocument.DocumentIDGenerated',
                                                companyID = drp_rs_CompanyNameInput.Selected.ID Or divisionID = drp_rs_CompanyNameInput_2.Selected.ID Or documentTypeID = drp_rs_DocumentType.Selected.ID
                                            )
                                        ),
                                        Text(
                                            LookUp(
                                                'ASDocument.DocumentIDGenerated',
                                                companyID = drp_rs_CompanyNameInput.Selected.ID Or divisionID = drp_rs_CompanyNameInput_2.Selected.ID Or documentTypeID = drp_rs_DocumentType.Selected.ID
                                            ).lastAutoNumber + 1,
                                            "0####"
                                        ),
                                        Text(
                                            01,
                                            "0####"
                                        )
                                    )
                                }
                            );
                            UpdateContext(
                                {
                                    locDocumentIDGenerate: drp_rs_CompanyNameInput.Selected.shortName & "-" & drp_rs_CompanyNameInput_2.Selected.shortName & "-" & drp_rs_DocumentType.Selected.shortName & locNumberCountRequest & "-" & Upper(
                                        Concat(
                                            Split(
                                                txt_rs_DocumentName.Text,
                                                " "
                                            ),
                                            Left(
                                                Value,
                                                1
                                            )
                                        )
                                    )
                                }
                            )
                        );
                    Text: =If(locReview = false,"Tạo","Gửi")
                    ZIndex: =3

    ctn_rs_Header As groupContainer.horizontalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Height: =104
        LayoutMode: =LayoutMode.Auto
        Width: =1170
        X: =196
        ZIndex: =24

        ctn_rs_Tab As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Height: =101
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =5
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =35
            Width: =1229
            X: =137
            ZIndex: =1

            btn_rs_Create As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(94, 94, 94, 1)
                DisabledFill: =
                Fill: =RGBA(255, 255, 255, 1)
                Height: =28
                HoverFill: =ColorFade(RGBA(73, 113, 215, 1), -20%)
                OnSelect: =Navigate('Home User Screen')
                PressedFill: =RGBA(73, 113, 215, 1)
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =13
                Text: ="Tổng quan"
                Width: =104
                X: =117
                Y: =36
                ZIndex: =1

            btn_rs_Overview As button:
                BorderStyle: =BorderStyle.None
                Fill: =RGBA(73, 113, 215, 1)
                Height: =28
                HoverFill: =ColorFade(Self.Fill, -20%)
                PressedColor: =Color.White
                PressedFill: =Self.Fill
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =13
                Text: ="Tạo mới"
                Width: =104
                X: =191
                Y: =36
                ZIndex: =2

        ctn_rs_Info As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =RGBA(220, 228, 252, 1)
            FillPortions: =0.3
            Height: =80
            LayoutMinHeight: =100
            LayoutMinWidth: =50
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =10
            PaddingRight: =10
            RadiusBottomLeft: =20
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =20
            ZIndex: =2

            img_hs_Avatar_1 As image:
                AlignInContainer: =AlignInContainer.Center
                Height: =50
                Image: =User().Image
                LayoutMinHeight: =50
                RadiusBottomLeft: =img_hs_Avatar_1.Height
                RadiusBottomRight: =img_hs_Avatar_1.Height
                RadiusTopLeft: =img_hs_Avatar_1.Height
                RadiusTopRight: =img_hs_Avatar_1.Height
                Width: =50
                ZIndex: =1

            ctn_hs_Info2_1 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =5
                ZIndex: =2

                lbl_hs_Name_1 As label:
                    FontWeight: =FontWeight.Bold
                    PaddingTop: =20
                    Size: =12
                    Text: =User().FullName
                    Wrap: =false
                    ZIndex: =1

                lbl_hs_Mail_1 As label:
                    PaddingBottom: =20
                    Size: =12
                    Text: =User().Email
                    Wrap: =false
                    ZIndex: =2

    ctn_Navigate_3 As groupContainer.verticalAutoLayoutContainer:
        BorderStyle: =BorderStyle.None
        DropShadow: =DropShadow.None
        Fill: =RGBA(255, 255, 255, 1)
        Height: =768
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =70
        RadiusBottomLeft: =20
        RadiusBottomRight: =0
        RadiusTopLeft: =20
        RadiusTopRight: =0
        Width: =196
        ZIndex: =25

        ctn_HeaderMenu_4 As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =100
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =1
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            ZIndex: =1

            img_Logo_3 As image:
                Height: =110
                Image: =Name
                Width: =50
                X: =11
                Y: =13
                ZIndex: =1

            lbl_HeaderTitleMenu_4 As label:
                Color: =RGBA(73, 113, 215, 1)
                FontWeight: =FontWeight.Bold
                Size: =15
                Text: ="Quy trình"
                Width: =145
                ZIndex: =2

        ctn_NavigationMenu_3 As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =RGBA(255, 255, 255, 1)
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =100
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            ZIndex: =3

            gal_NavigationMenu_3 As gallery.galleryVertical:
                DelayItemLoading: =true
                Fill: =RGBA(255, 255, 255, 1)
                Height: =652
                Items: |-
                    =If(gblRecUser.roleID = 1,Table({ID:1,Image:Home,Title:"Trang chủ",Navigate:'Home User Screen'}),gblRecUser.roleID = 2 Or gblRecUser.roleID = 4,Table({ID:1,Image:Home,Title:"Trang chủ",Navigate:'Home User Screen'},{ID:2,Image:'Admin Settings Male',Title:"Phê duyệt",Navigate:'Approve Screen'}),gblRecUser.roleID = 3,Table({ID:1,Image:Home,Title:"Trang chủ",Navigate:'Home Manager Screen'},{ID:2,Image:'Admin Settings Male',Title:"Phê duyệt",Navigate:'Approve Screen'},{ID:3,Image:'Data Recovery',Title:"Thiết lập",Navigate:'User Screen'}),gblRecUser.roleID = 5,Table({ID:1,Image:'Data Recovery',Title:"Thiết lập",Navigate:'User Screen'}))
                Layout: =Layout.Vertical
                LayoutMinHeight: =287
                LayoutMinWidth: =0
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: =Navigate(ThisItem.Navigate)
                ShowScrollbar: =false
                TemplateSize: =50
                Width: =155
                X: =251
                Y: =115
                ZIndex: =1

                img_MenuImage_3 As image:
                    Height: =30
                    Image: =ThisItem.Image
                    OnSelect: =Select(Parent)
                    Width: =40
                    X: =15
                    Y: =10
                    ZIndex: =1

                lbl_MenuTitle_3 As label:
                    Color: =RGBA(149, 149, 149, 1)
                    FontWeight: =FontWeight.Semibold
                    Height: =29
                    OnSelect: =Select(Parent)
                    Text: =ThisItem.Title
                    Width: =117
                    X: =60
                    Y: =10
                    ZIndex: =2

                btn_Select_4 As button:
                    BorderThickness: =0
                    Fill: =If(ThisItem.ID = gblMenuFunctionSelected,RGBA(149, 149, 149,0.2),RGBA(0, 0, 0, 0))
                    Height: =50
                    HoverFill: =ColorFade(RGBA(149, 149, 149,0.4), -20%)
                    OnSelect: |-
                        =Select(Parent);
                        Set(gblMenuFunctionSelected,ThisItem.ID)
                    PressedFill: =RGBA(149, 149, 149,0.5)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: =""
                    Width: =195
                    X: =-5
                    ZIndex: =3

        btn_Exit_3 As button:
            AlignInContainer: =AlignInContainer.Center
            BorderColor: =RGBA(73, 113, 215, 1)
            Color: =RGBA(116, 116, 116, 1)
            Fill: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(73, 113, 215, 1), -20%)
            OnSelect: =Exit()
            PressedColor: =Color.White
            PressedFill: =RGBA(73, 113, 215, 1)
            Text: ="Thoát"
            X: =18
            Y: =682
            ZIndex: =4

    ctn_rs_Review As groupContainer.manualLayoutContainer:
        Fill: =RGBA(0, 0, 0, 0.5)
        Height: =768
        RadiusBottomLeft: =20
        RadiusBottomRight: =20
        RadiusTopLeft: =20
        RadiusTopRight: =20
        Visible: =locSubmit
        Width: =1366
        ZIndex: =26

        btn_ds_BackGround_7 As button:
            BorderStyle: =BorderStyle.None
            DisabledFill: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.Disabled
            Height: =190
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Text: =""
            Width: =608
            X: =375
            Y: =297
            ZIndex: =1

        lbl_ds_Title_12 As label:
            FontWeight: =FontWeight.Bold
            Text: ="Xác nhận"
            X: =387
            Y: =302
            ZIndex: =2

        shp_ds_Deco_15 As rectangle:
            Fill: =RGBA(202, 202, 202, 1)
            Height: =1
            Width: =608
            X: =375
            Y: =347
            ZIndex: =3

        ico_ds_Cancel_7 As icon.Cancel:
            Color: =RGBA(149, 149, 149, 1)
            Height: =29
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({locSubmit:false})
            Width: =25
            X: =942
            Y: =308
            ZIndex: =4

        lbl_ds_DepartmentName_6 As label:
            FontWeight: =FontWeight.Semibold
            Text: ="Bạn chắc chắn muốn gửi yêu cầu ?"
            Width: =596
            X: =387
            Y: =369
            ZIndex: =5

        shp_ds_Deco_5 As rectangle:
            Fill: =RGBA(202, 202, 202, 1)
            Height: =1
            Width: =608
            X: =375
            Y: =432
            ZIndex: =6

        btn_ds_Submit_9 As button:
            BorderThickness: =1
            Fill: =RGBA(0, 89, 204, 1)
            Height: =36
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
                =//Gửi yêu cầu
                Patch(
                    'ASDocument.DocumentRequest',
                    Defaults('ASDocument.DocumentRequest'),
                    {
                        documentGroupID: drp_rs_DocumentLevel.Selected.documentGroupID,
                        levelID: drp_rs_DocumentLevel.Selected.levelID,
                        documentTypeID: drp_rs_DocumentType.Selected.ID,
                        userID: gblRecUser.userID,
                        documentID: If(drp_rs_DocumentLevel.Selected.documentGroupID = 1,locDocumentIDGenerate,txt_rs_FileCodeInput.Text),
                        createdDateValue: Value(Day(Today()) & Month(Today()) & Year(Today())),
                        currentApproveLevel:1,
                        description:txt_rs_DocumentName.Text,
                        documentName:txt_rs_DocumentName.Text,
                        maxApproveLevel:If(Or(drp_rs_DocumentLevel.Selected.levelID = 3,drp_rs_DocumentLevel.Selected.levelID = 4),2,3),
                        status:1,
                        pageSignNumber:Value(txt_rs_SignPage.Text),
                        requestTimeNum:0,
                        companyID:drp_rs_CompanyNameInput.Selected.ID,
                        divisionID:drp_rs_CompanyNameInput_2.Selected.companyID,
                        active:1,
                        lastSignNum:1
                    },frm_rs_Document.Updates
                );
                
                //Cập nhật số thứ tự mới nhất của phân loại yêu cầu
                Patch('ASDocument.DocumentIDGenerated',Defaults('ASDocument.DocumentIDGenerated'),{companyID:drp_rs_CompanyNameInput.Selected.ID,divisionID:drp_rs_CompanyNameInput_2.Selected.companyID,documentTypeID:drp_rs_DocumentType.Selected.ID,lastAutoNumber:Value(locNumberCountRequest)});
                
                //Tạo luồng các dòng quy trình phê duyệt yêu cầu
                //Sắp xếp thứ tự các dòng
                ClearCollect(
                    colRownumberApprovalProcess,
                    ForAll(
                        Sequence(CountRows(colApprovesPeopleProcess)),
                        Patch(
                            Last(FirstN(colApprovesPeopleProcess, Value)),
                            {sort: Value}
                        )
                    )
                );
                //Tạo danh sách phê duyệt
                'ASDocument.AddRequestApproveProcess'.Run(JSON(Sort(colRownumberApprovalProcess,approveProcess,SortOrder.Ascending),JSONFormat.IncludeBinaryData));
                
                //Lưu tài liệu liên quan
                Patch('ASDocument.RelatedDocument',Defaults('ASDocument.RelatedDocument'),{documentID:locDocumentIDGenerate,active:1},frm_rs_Attachment.Updates);
                
                //Gửi mail thông báo cho cấp duyệt đầu
                'ASDocument.SendMail'.Run(LookUp(gblColAllUser,userID = First(colApprovesPeopleProcess).userID).email,"Yêu cầu ký duyệt cho văn bản " & txt_rs_DocumentName.Text,"Mã tài liệu/hồ sơ: " & locDocumentIDGenerate & "<br>" & "Cấp tài liệu: " & drp_rs_DocumentLevel.Selected.name & "<br>" & "Loại văn bản: " & drp_rs_DocumentType.Selected.name & "<br>" & "Công ty: " & drp_rs_CompanyNameInput.Selected.name & "<br>" & "Đơn vị: " & drp_rs_CompanyNameInput_2.Selected.name & "<br>" & "Người tạo: " & gblRecUser.fullName & "<br>" & "Thời gian tạo: " & Now());
                
                Notify(
                    "Gửi thành công",
                    NotificationType.Success,
                    1500
                );
                
                //Làm mới các trường
                Reset(drp_rs_DocumentLevel);Reset(drp_rs_DocumentType);Reset(drp_rs_CompanyNameInput);Reset(drp_rs_CompanyNameInput_2);Reset(txt_rs_DocumentName);ResetForm(frm_rs_Document);Reset(txt_rs_SignPage);ResetForm(frm_rs_Attachment);Clear(colApprovesPeopleProcess);Clear(colMSDByDocumentLevel);
                
                UpdateContext({locSubmit: false})
            PressedColor: =RGBA(255,255,255,1)
            PressedFill: =Self.Fill
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Text: ="Gửi"
            Width: =87
            X: =879
            Y: =443
            ZIndex: =7

        btn_ds_Cancel_7 As button:
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =36
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
                =UpdateContext({locSubmit:false})
            PressedColor: =RGBA(0,0,0,1)
            PressedFill: =Self.Fill
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Text: ="Hủy"
            Width: =87
            X: =781
            Y: =443
            ZIndex: =8

    Label5 As label:
        Text: =
        X: =46
        Y: =193
        ZIndex: =27

